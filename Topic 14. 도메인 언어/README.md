# Topic 14. 도메인 언어

컴퓨터 언어는 여러분이 문제에 대해, 또 의사소통에 대해 생각하는 방식에 영향을 미친다.  
모든 언어는 제각기 일련의 특징들을 내세우는데, 이런 특징들은 모두 어떤 해결 방안을 제시하기도 하지만 가려버리기도 한다.  
문제 도메인의 언어가 어떤 프로그래밍 해결 방안을 제안하기도 하는데, 우리 생각에는 이것이 프로그래밍 언어의 사고방식 보다 더 중요하다.  
우리는 언제나 애플리케이션 도메인의 어휘를 사용해서 코드를 작성하려고 노력한다.  
실용주의 프로그래머라면 어떤 경우에는 한차원 더 나아가서 그 도메인의 실제 어휘와 문법, 의미론을(즉 그 도메인의 언어를) 사용해서 프로그래밍할 수도 있다.  

## 실세계 도메인 언어의 예
### RSpec
루비용 테스트 라이브러리로, 대다수 현대 언어에 비슷한 테스트 라이브러리를 만들도록 영감을 주었다.

### 큐컴버
큐컴버를 사용하면 프로그래밍 언어에 종속되지 않은 테스트를 정의할 수 있다.  
자연어와 유사한 문법을 사용하기 떄문에, 정의한 테스트에서 문구를 인식하여 테스트에 필요한 매개변수를 추출하는 matcher도 정의해야 한다.  

### 피닉스 라우터
대부분의 웹 프레임워크에는 들어오는 HTTP요청을 코드의 핸들러 함수로 전달하는 라우팅 도구가 있다. 그중 엘릭서(Elixir)로 만든 웹 프레임워크인 피닉스를 예로 들었다.  

### 앤서블
앤서블은 소프트웨어를 설정하는 도구다. 주로 다수의 원격 서버를 관리할 때 사용하는데, 제공된 명세를 읽은 후 반영하기 위해 필요한 작업을 서버에서 수행한다.  
명세는 일반 텍스트로 데이터 구조를 표현하는 YAML로 작성할 수 있다.  

## 도메인 언어의 특성
RSpec 과 피닉스 라우터는 이들을 구현하는 호스트 언어인 루비와 엘릭서로 원하는 내용을 쓴다.  
큐컴버 테스트나 앤서블 명세는 그들 자체의 언어를 사용한다.  
결과적으로 RSpec이나 피닉스 라우터 언어는 여러분이 실행시키는 코드 안으로 들어간다. 도메인 언어가 원래 코드의 어휘를 진짜로 확장시키는 것이다.  
큐컴버와 앤서블 언어는 별도의 코드가 이 언어를 읽어 들여서 사용할 수 있는 형태로 바꾼다.  
우리는 RSpec이나 피닉스 같은 경우를 **내부 도메인 언어**, 큐컴버나 앤서블 같은 경우를 **외부 도메인 언어** 라고 부른다.  

## 내부와 외부 언어의 장단점
일반적으로 내부 도메인 언어는 호스트 언어의 기능을 쓸 수 있는 장점이 있다.  
내부 도메인 언어의 단점은 호스트 언어의 문법과 의미론을 따라야만 한다. 이런 부분이 유연한 언어도 있긴 하지만 그래도 여전히 원하는 언어와 구현할 수 있는 언어 사이에서 어느정도 타협해야만 한다.  
외부 언어는 이런 제약이 없다. 우리가 정의하려는 언어의 파서(parser)를 만들기만 하면 된다. 대신 좋은 파서를 만드는게 결코 쉽지 않을것이다.  
도메인 언어를 만들려면 프로젝트에 어느 정도 추가 비용이 발생한다. 그럼에도 이를 상쇄할 만큼 비용을 절감할 수 있으리라는 확신이 있어야 한다.  
기본적으로는 가능하다면 YAML이나 JSON, CSV 처럼 널리 통용되는 외부 언어를 사용하라. 그게 아니라면 내부언어를 고려하라.  
단, 외부 언어 도입은 애플리케이션의 사용자가 직접 도메인 언어로 코드를 작성하는 경우에만 추천한다.  

## 손쉽게 만드는 내부 도메인 언어
마지막으로 호스트 언어의 문법이 노출되어도 상관없다면 사용 할 수 있는 방법이 있는데, 메타프로그래밍을 남발하는 대신 그냥 함수를 써서 구현하라. 사실 RSpec도 그런 방식을 사용한다.  
