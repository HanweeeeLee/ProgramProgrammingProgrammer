# Topic 40. 리팩터링
리팩터링이란? 밖으로 드러나는 동작은 그대로 유지한 채 내부 구조를 변경함으로서 이미 존재하는 코드를 재구성하는 체계적 기법이다.  
이 정의에서 핵심은  
1. 이 활동은 체계적이다. 아무렇게나 하는것이 아니다.
2. 밖으로 드러나는 동작은 바뀌지 않는다. 기능을 추가하는 작업이 아니다.

밖으로 드러나는 동작이 바뀌지 않는다는 것을 보장하려면 코드의 동작을 검증하는 좋은 자동화된 단위 테스트가 필요하다.  

## 리팩터링은 언제하는가?
리팩터링은 우리가 무언가를 알게 되었을때 한다.  
어쩌면 우리는 무엇이든 무언가 잘못되었다는 생각이 들때가 있다. 주저하지말고 바로 변경하라.
 - 중복
 - 직교적이지 않은 설계
 - 더이상 유효하지 않은 지식
 - 사용 사례
 - 성능
 - 테스트 통과

## 리팩터링은 어떻게 하는가?
리팩터링은 천천히, 신중하게, 조심스럽게 진행해야 하는 작업이다.  
마틴 파울러는 리팩터링 하는 방법에 대해 몇가지 간단한 조언을 해주었는데
1. 리팩터링과 기능 추가를 동시에 하지 말라
2. 리팩터링을 시작하기전 테스트가 있는지 먼저 확인하라. 할수 있는 한 자주 테스트를 돌려보라. 이러면 우리가 바꾼것 때문에 무언가 망가졌을 경우 그 사실을 빠르게 알수 있다.
3. 단계를 나누어 신중하게 작업하라. 작은 단위로 작업해야 한다. 단계를 작게 나누고 한 단계가 끝날 때마다 테스트를 돌린다면 기나긴 디버깅 작업을 피할 수 있다.

리팩터링 만으로 부족해서 결국 외부에서 보이는 동작이나 API를 바꿔야 한다면, 일부러 빌드를 깨뜨려 보는것이 유용할 수도 있다.  
리팩터링 대상 코드에 의존하는 옛날 코드들은 컴파일이 안 되게 만드는 것이다. 이러면 고쳐야 하는 부분이 어디인지 알아낼 수 있다.  
