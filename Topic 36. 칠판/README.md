# Topic 36. 칠판
형사들의 살인사건 회의  
![istockphoto-1284171673-1024x1024](https://github.com/WBBookStudy/ProgramProgrammingProgrammer/assets/60125719/c232a61d-7af7-4d7c-a449-32e2ec80ee03)
칠판 접근 방법의 몇 가지 특정은 다음과 같다.
 - 형사들은 다른 형사의 존재를 알 필요가 없다. 형사들은 칠판을 보며 새로운 정보를 얻고, 자기가 발견한 것을 칠팔에 덧붙인다
 - 형사들은 저마다 서로 다른 분야의 훈련을 받았거나, 다른 수준의 학력과 경험을 지녔을 수 있으며, 아예 같은 관할 구역에 속하지 않을 수도 있다.
 - 수사 과정에서 여러 형사가 들어오거나 나갈 수 있고 임무 교대 시간도 제각기 다를 수 있다.
 - 칠판에는 제한 없이 어떤 것이든 올릴 수 있다. 사진, 증언, 물리적 증거 등등

 ## 칠판 사용 사례
 주택 담보 대출이나 신용 대출 신청을 받아서 처리하는 프로그램을 작성한다고 하자.  
 정부, 금융위원회, 지방자치단체 등등 자신마의 규정이 있기 때문에 끔찍하게 복잡하다.  
 우리가 씨름해야 할 문제들은 다음과 같다.
  - 응답은 정해진 순서 없이 도착한다. 예를 들어 신용 조회는 상당한 시간이 걸리지만 이름이나 주소는 바로 응답이 온다.
  - 여러 표준 시간대에 걸쳐 있는 여러 사무실에 분산된 여러 사람이 데이터를 수집할 수도 있다.
  - 어떤 데이터 수집은 다른 시스템이 자동으로 해주기도 한다. 그러나 이 데이터도 비동기적으로 도착할 수 있다는 점은 마찬가지다.
  - 어떤 데이터는 다른 데이터에 의존하기 까지 한다. 예를 들어 자동차 명의 조회는 소유 증명서나 보험 증명서를 받은 후에 시작해야 할 수도 있다.
  - 새로운 데이터가 도착하면 새로운 질문을 하거나 새로운 정책을 적용해야 할 수도 있다. 예를들면 신용평과 결과가 안좋았을 때 추가 서류를 요청할 수 있다.
  
이럴떄 칠판 시스템을 법적 요구 사항을 캡슐화 하는 규칙 엔진과 함께 사용하면 우아하게 해결 가능하다.  

## 메시지 시스템과 칠판의 유사성
카프카나 NATS같은 메시징 시스템을 칠판으로 사용할 수 있고, 여러 액터를 실행하는 플랫폼으로도 사용할 수 있다. 물론 둘 다 동시에도 가능함.

## 하지만 그렇게 간단하지 않다...
아키텍처에서 액터와 칠판, 마이크로서비스를 활용하면 애플리케이션에서 생길 수 있는 모든 종류의 동시성 문제를 예방할 수 있다. 하지만 거기에는 비용이 따른다.  
이렇게 하면 많은 동작이 간접적으로 일어나므로 분석이 더 힘들다.  
메시지 형식 및 API를 모아두는 중앙 저장소를 운영하면 도움이 되고, 코드나 문서까지 생성해준다면 더욱 좋다.  
메시지 정보를 추적할 수 있는 도구도 필요할 것이다.  
마지막으로 이런 종류의 시스템은 맞춰야 하는 구성 요소 수가 더 많기 때문에 배포하고 관리하기가 더 까다롭다.  
하지만 시스템이 더 잘게 쪼개지고, 전체 시스템이 아니라 개별 액터만 교체하여 시스템을 업데이트할 수 있기 때문에 보상은 있다.









































